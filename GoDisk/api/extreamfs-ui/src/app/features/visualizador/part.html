<h2 class="title">Particiones de {{ baseName(diskPath) }}</h2>

<div *ngIf="loading" class="state">Actualizandoâ€¦</div>
<div *ngIf="!loading && error" class="state error">{{ error }}</div>

<div *ngIf="!loading && !error">
  <div class="meta">
    <span><b>Disco:</b> {{ diskPath || 'â€”' }}</span>
    <span><b>ID base:</b> {{ id }}</span>
  </div>

  <div *ngIf="parts.length === 0" class="state">
    No se detectaron particiones en este disco.
  </div>

  <div *ngIf="parts.length" class="grid">
    <ng-container *ngFor="let p of parts">
      <!-- Montada: link al explorador de archivos /visualizador/:id/fs?ruta=/ -->
      <a *ngIf="p.mountId as mid; else notMounted"
         class="part"
         [class.pm]="p.kind === 'P'"
         [class.lg]="p.kind === 'L'"
         [routerLink]="['/visualizador', mid, 'fs']"
         [queryParams]="{ ruta: '/' }">
        <div class="icon" [attr.aria-label]="p.kind === 'P' ? 'ParticiÃ³n primaria' : 'ParticiÃ³n lÃ³gica'">
          {{ p.kind === 'P' ? 'ðŸ§±' : 'ðŸ§©' }}
        </div>
        <div class="name" [title]="p.name">{{ p.name }}</div>
        <div class="sub">
          {{ p.kind === 'P' ? 'Primaria' : 'LÃ³gica' }} â€¢
          {{ p.size | number }} bytes ({{ p.percent | number:'1.0-2' }}%)
        </div>
        <div class="status">Montada: <code>{{ mid }}</code></div>
      </a>

      <!-- No montada: tarjeta sin routerLink -->
      <ng-template #notMounted>
        <div class="part disabled"
             [class.pm]="p.kind === 'P'"
             [class.lg]="p.kind === 'L'">
          <div class="icon" [attr.aria-label]="p.kind === 'P' ? 'ParticiÃ³n primaria' : 'ParticiÃ³n lÃ³gica'">
            {{ p.kind === 'P' ? 'ðŸ§±' : 'ðŸ§©' }}
          </div>
          <div class="name" [title]="p.name">{{ p.name }}</div>
          <div class="sub">
            {{ p.kind === 'P' ? 'Primaria' : 'LÃ³gica' }} â€¢
            {{ p.size | number }} bytes ({{ p.percent | number:'1.0-2' }}%)
          </div>
          <div class="status off">No montada</div>
        </div>
      </ng-template>
    </ng-container>
  </div>

  <p style="margin-top:14px;">
    <a routerLink="/visualizador">âŸµ Volver</a>
  </p>
</div>
